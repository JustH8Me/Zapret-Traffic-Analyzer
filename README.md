# Game Traffic Analyzer for Zapret

Простая утилита для поиска IP-адресов и доменов, к которым обращаются игры (Apex Legends, ARC Raiders и др.) или программы (Discord). 

Помогает быстро собрать актуальные списки для **Zapret**, когда игра работает, но не грузится чат, лобби или не заходит в матч.


<img width="586" height="393" alt="изображение" src="https://github.com/user-attachments/assets/aa6c9c91-6ae3-4ee2-93d0-3a6e64aa8881" />

### Что делает:
* **Ловит трафик по процессам:** видит не только саму игру, но и сопутствующие службы (Steam, античиты, лаунчеры).
* **Сортирует по типам:** сам раскидывает адреса в `domains.txt`, `ips-tcp.txt` (лобби/вход) и `ips-udp.txt` (голос/матч).
* **Группирует в подсети:** превращает одиночные IP в формат `x.x.x.0/24`, чтобы не добавлять каждый адрес по отдельности.
* **Проверяет доступность:** показывает, какие сервера доступны, а на каких висит «тайм-аут» (возможная блокировка).

### Как пользоваться:
1.  Запусти программу **от админа**.
2.  Напиши название процесса (например, `r5apex.exe` или `НазваниеИгры.exe`).
3.  Нажми **СТАРТ**.
4.  Зайди в игру и поиграй пару минут (чтобы прошел обмен данными в чате и матче).
5.  Нажми кнопку **ДОМЕНЫ** — программа попытается сопоставить пойманные IP с их именами (полезно для `domains.txt`).
6.  Нажми **СТОП** и **СОХРАНИТЬ** (можно нажать **ПКМ** на списке, чтобы выбрать и сохранить только конкретные типы данных).
7.  Забирай готовые списки из папки `zapret-lists` и вставляй их в свой батник Zapret.

### Что делать с этими файлами?

Если ты не хочешь разбираться в сетевых протоколах, вот кратко, какой файл за что обычно отвечает:

*   **`domains.txt` (Домены):** Это «адреса» сайтов.
    *   **За что отвечают:** Авторизация (логин/пароль), работа лаунчера, загрузка новостей и картинок, списки серверов. 
    *   *Пример:* В Дискорде это сам интерфейс и чаты. В играх — магазин и окно логина.
*   **`ips-tcp.txt` (Lobby/API):**
    *   **За что отвечают:** «Тяжелые» данные, где важна точность. Это лобби игры, поиск матча, работа инвентаря, текстовый чат и соединение с сервером статистики.
    *   *Если у тебя бесконечный "Connecting to lobby" — тебе сюда.*
*   **`ips-udp.txt` (Gameplay/Voice):**
    *   **За что отвечают:** Самый быстрый трафик. Это сама игра (движения персонажей, стрельба) и **голосовая связь**.
    *   *Если ты зашел в лобби, но не заходит в сам матч или ты никого не слышишь в войсе — тебе сюда.*

---

### ⚙️ Как добавить это в Zapret?

Открой свой батник (`.bat` файл), которым ты запускаешь Zapret, и найди там параметры `--list-hosts` или `--list-ips`. 

**Пример настройки:**
1. Просто добавь нужные домена в list-general.txt а ip в ipset-названиеТвое.txt
   
**ИЛИ**

1. Файл **`domains.txt`** обычно добавляется через параметр: 
   `--list-hostnames=zapret-lists/domains.txt`
2. Файлы **`ips-tcp.txt`** и **`ips-udp.txt`** добавляются через параметр:
   `--list-ips=zapret-lists/ips-tcp.txt --list-ips=zapret-lists/ips-udp.txt`
## ВАЖНО! Дурить udp и tcp трафик нужно по разному! Если не разбераетесь - лучше закиньте нейронке (ну или напишите мне, я попытаюсь помочь чем смогу)

### Известные проблемы:
* **Ложные блокировки:** Если сервер сам оборвал соединение или у него закрыты порты для проверки, программа напишет «БЛОК», даже если адрес не заблокирован РКН.
* **Права доступа:** Без запуска от имени администратора трафик отображаться не будет.
* **Зависшие сессии:** Если программа закрылась некорректно и выдает ошибку ресурсов (0x800705AA), нужно перезагрузить компьютер, чтобы очистить системные логгеры.
* **UDP проверка:** Статус UDP-серверов проверяется через Ping, поэтому если сервер игнорирует пинги, он всегда будет «красным».

### Требования:
* Windows 10/11.
* Запуск от имени администратора (нужно для доступа к статистике сети).
* .NET 8.0.
